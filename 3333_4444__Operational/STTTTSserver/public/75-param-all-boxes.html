<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>75 Parameters - Complete View</title>
  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', monospace;
      background: #0a0e27;
      color: #e0e0e0;
      padding: 20px;
    }
    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
      text-align: center;
    }
    .header h1 { font-size: 28px; margin-bottom: 10px; }
    .stats { display: flex; gap: 20px; justify-content: center; margin-top: 15px; }
    .stat-box {
      background: rgba(255,255,255,0.2);
      padding: 10px 20px;
      border-radius: 8px;
    }
    .stat-value { font-size: 32px; font-weight: bold; }
    .stat-label { font-size: 12px; opacity: 0.8; }
    
    .category-title {
      background: #667eea;
      color: white;
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0 10px 0;
      font-size: 18px;
      font-weight: bold;
    }
    
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .param-box {
      background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
      border: 2px solid #334155;
      padding: 15px;
      border-radius: 8px;
      transition: all 0.3s;
    }
    
    .param-box:hover {
      border-color: #667eea;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }
    
    .param-name {
      font-size: 11px;
      color: #94a3b8;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .param-value {
      font-size: 24px;
      font-weight: bold;
      color: #10b981;
      margin-bottom: 5px;
    }
    
    .param-unit {
      font-size: 12px;
      color: #64748b;
    }
    
    .status-ok { border-color: #10b981; }
    .status-warning { border-color: #f59e0b; }
    .status-critical { border-color: #ef4444; }
  </style>
</head>
<body>
  <div class="header">
    <h1>ðŸŽ¯ 75-Parameter Monitoring System</h1>
    <p>Real-Time Audio Translation Quality Monitoring</p>
    <div class="stats">
      <div class="stat-box">
        <div class="stat-value" id="totalParams">75</div>
        <div class="stat-label">Total Parameters</div>
      </div>
      <div class="stat-box">
        <div class="stat-value" id="baseParams">55</div>
        <div class="stat-label">Base Parameters</div>
      </div>
      <div class="stat-box">
        <div class="stat-value" id="dspParams">20</div>
        <div class="stat-label">DSP Parameters</div>
      </div>
    </div>
  </div>
  
  <div id="allParameters"></div>

  <script>
    const socket = io('http://20.170.155.53:3021');
    let currentStation = 'station-1';

    async function loadMetrics() {
      try {
        const response = await fetch('http://20.170.155.53:3021/api/stations/' + currentStation + '/metrics');
        const data = await response.json();
        displayAllParameters(data.metrics);
      } catch (error) {
        console.error('Error:', error);
      }
    }

    function displayAllParameters(metrics) {
      const container = document.getElementById('allParameters');
      let html = '';
      let totalCount = 0;
      
      const categoryOrder = ['buffer', 'latency', 'packet', 'audioQuality', 'performance', 'custom', 'dsp'];
      const categoryNames = {
        buffer: 'Buffer Management (7 params)',
        latency: 'Latency Metrics (4 params)',
        packet: 'Packet Statistics (7 params)',
        audioQuality: 'Audio Quality (8 params)',
        performance: 'Performance (5 params)',
        custom: 'Custom Metrics (7 params)',
        dsp: 'DSP Enhancement (20 params)'
      };
      
      categoryOrder.forEach(category => {
        if (!metrics[category]) return;
        
        html += '<div class="category-title">' + categoryNames[category] + '</div>';
        html += '<div class="grid">';
        
        const values = metrics[category];
        for (const [key, value] of Object.entries(values)) {
          if (typeof value === 'object' && value !== null) {
            // Nested object (DSP subcategories)
            for (const [subkey, subvalue] of Object.entries(value)) {
              totalCount++;
              const displayValue = typeof subvalue === 'number' ? subvalue.toFixed(2) : subvalue;
              html += `
                <div class="param-box status-ok">
                  <div class="param-name">${category}.${key}.${subkey}</div>
                  <div class="param-value">${displayValue}</div>
                  <div class="param-unit"></div>
                </div>
              `;
            }
          } else {
            totalCount++;
            const displayValue = typeof value === 'number' ? value.toFixed(2) : value;
            html += `
              <div class="param-box status-ok">
                <div class="param-name">${category}.${key}</div>
                <div class="param-value">${displayValue}</div>
                <div class="param-unit"></div>
              </div>
            `;
          }
        }
        
        html += '</div>';
      });
      
      container.innerHTML = html;
      document.getElementById('totalParams').textContent = totalCount;
    }

    socket.on('station-update', (station) => {
      if (station.id === currentStation) loadMetrics();
    });

    loadMetrics();
    setInterval(loadMetrics, 2000);
  </script>
</body>
</html>
